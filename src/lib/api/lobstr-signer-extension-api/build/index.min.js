!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.lobstrSignerExtensionApi=o():e.lobstrSignerExtensionApi=o()}(this,(()=>(()=>{"use strict";var e,o,n={d:(e,o)=>{for(var t in o)n.o(o,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>a,getPublicKey:()=>s,isAllowed:()=>T,isBrowser:()=>d,isConnected:()=>l,setAllowed:()=>c,signTransaction:()=>S}),function(e){e.LOAD_STATE="LOAD_STATE",e.LOGIN="LOGIN",e.LOGOUT="LOGOUT",e.SIGN_TRANSACTION="SIGN_TRANSACTION",e.GRANT_ACCESS="GRANT_ACCESS",e.REJECT_ACCESS="REJECT_ACCESS"}(e||(e={})),function(e){e.REQUEST_ACCESS="REQUEST_ACCESS",e.SIGN_TRANSACTION="SUBMIT_TRANSACTION",e.REQUEST_CONNECTION_STATUS="REQUEST_CONNECTION_STATUS",e.REQUEST_ALLOWED_STATUS="REQUEST_ALLOWED_STATUS",e.SET_ALLOWED_STATUS="SET_ALLOWED_STATUS"}(o||(o={}));const r="LOBSTR_CONNECTION_KEY",i=e=>{const n=Date.now()+Math.random();return window.postMessage({source:"LOBSTR_EXTERNAL_MSG_REQUEST",messageId:n,...e},window.location.origin),new Promise((t=>{let r=0;e.type===o.REQUEST_CONNECTION_STATUS&&(r=setTimeout((()=>{t({isConnected:!1}),window.removeEventListener("message",i)}),2e3));const i=e=>{var o,s;e.source===window&&"LOBSTR_EXTERNAL_MSG_RESPONSE"===(null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.source)&&(null===(s=null==e?void 0:e.data)||void 0===s?void 0:s.messagedId)===n&&(t(e.data),window.removeEventListener("message",i),clearTimeout(r))};window.addEventListener("message",i,!1)}))},s=()=>d?(async()=>{let e={publicKey:"",error:"",connectionKey:""};try{e=await i({type:o.REQUEST_ACCESS})}catch(e){console.error(e)}const{publicKey:n,connectionKey:t,error:r}=e;if(r)throw r;return{publicKey:n,connectionKey:t}})().then((({publicKey:e,connectionKey:o})=>{var n;return null===(n=null===window||void 0===window?void 0:window.sessionStorage)||void 0===n||n.setItem(r,o),e})):Promise.resolve(""),S=e=>{var n;return d?(async(e,n)=>{let t={signedTransaction:"",error:""};console.log(e,n);try{t=await i({transactionXdr:e,connectionKey:n,type:o.SIGN_TRANSACTION})}catch(e){throw console.error(e),e}const{signedTransaction:r,error:s}=t;if(s)throw s;return r})(e,(null===(n=null===window||void 0===window?void 0:window.sessionStorage)||void 0===n?void 0:n.getItem(r))||""):Promise.resolve("")},l=()=>d?window.lobstrSignerExtension?Promise.resolve(window.lobstrSignerExtension):(async()=>{let e={isConnected:!1};try{e=await i({type:o.REQUEST_CONNECTION_STATUS})}catch(e){console.error(e)}return e.isConnected})():Promise.resolve(!1),T=()=>d?(async()=>{let e={isAllowed:!1};try{e=await i({type:o.REQUEST_ALLOWED_STATUS})}catch(e){console.error(e)}return e.isAllowed})():Promise.resolve(!1),c=()=>d?(async()=>{let e={isAllowed:!1,error:""};try{e=await i({type:o.SET_ALLOWED_STATUS})}catch(e){console.error(e)}const{isAllowed:n,error:t}=e;if(t)throw t;return n})():Promise.resolve(!1),d="undefined"!=typeof window,a={getPublicKey:s,signTransaction:S,isConnected:l,isAllowed:T,setAllowed:c};return t})()));
//# sourceMappingURL=index.min.js.map